jQuery.fn.spoiler=function(c){var a={setclass:"",title:!1,onlink:!1,effect:"none",srcid:null};jQuery.extend(a,c);var d="",e="",f="";getTitle=function(b){return d=null!==a.srcid?b.text():a.title?b.attr("title"):b.children("span").text()};getText=function(b){return e=a.onlink?b.attr("spoiler"):b.text()};chekTitle=function(b,a){if(""==b){a=jQuery.trim(a);var c=a.split(" ");b=c[0];for(var d=1;6>b.length;)b+=" "+c[d],d++;b+=" ..."}return b};jQuery("#spoiler-style").data("isset")||jQuery("head").append(jQuery("<style/>", {id:"spoiler-style","class":"sp-link",text:".spoiler {display: none;} .sp-link {cursor: pointer;}"}).data("isset",1));return this.each(function(){obj=jQuery(this);e=getText(obj);d=chekTitle(getTitle(obj),e);obj.data("srcid")&&(a.srcid=obj.data("srcid"));a.setclass&&(f=" "+a.setclass);a.onlink?obj.after(jQuery("<div/>",{"class":"spoiler "+obj.attr("class"),text:obj.attr("spoiler")}).data("effect",a.effect)).replaceWith(jQuery("<span/>",{"class":"sp-link"+f,text:d})):null!==a.srcid?(jQuery(a.srcid).hide().data("effect", a.effect),obj.data("srcid",a.srcid).addClass("sp-link").addClass(f)):obj.addClass("spoiler").data("effect",a.effect).before(jQuery("<span/>",{"class":"sp-link",text:d}))})};jQuery(document).delegate(".sp-link","click",function(){var c=jQuery(this).data("srcid")?jQuery(jQuery(this).data("srcid")):jQuery(this).next(".spoiler");switch(c.data("effect")){case "none":c.toggle();break;case "fade":c.fadeToggle();break;case "slide":c.slideToggle()}return!1});